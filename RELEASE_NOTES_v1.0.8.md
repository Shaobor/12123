# Release v1.0.8

## 修复

- **GET 保活兼容 404 重定向链**

  - 记录完整的重定向链，只要链路中未出现 `/m/login` 等登录页，就认定会话仍然有效
  - 解决黑龙江等省份保活最终返回 404 时被误判为“需要重新登录”的问题

- **登录状态传感器直接复用保活结果**

  - 移除额外的登录检查接口，避免重复访问政府服务
  - 保活更新立即同步到 `12123_会话状态` 传感器，状态更加实时

## 改进

- **车辆信息刷新机制**

  - 车辆信息协调器由保活成功后主动刷新，而非固定 10 分钟轮询
  - 扫码登录或 HA 重启后即可得到最新车辆数据，同时减少不必要的请求

- **启动即刻保活**

  - GET 保活任务在注册后立即执行一次，无需等待 5 分钟的间隔
  - 登录成功后立刻验证会话并刷新车辆信息

- **错误提示更友好**

  - 车辆信息传感器在服务异常时会展示错误码与错误描述，方便快速定位问题

## 安装

### 使用 HACS（推荐）

1. 确保已安装 [HACS](https://hacs.xyz/)
2. 在 HACS 中，进入“集成”页面
3. 点击右上角的三个点，选择“自定义仓库”
4. 添加此仓库 URL：`https://github.com/758639304/12123`
5. 选择类别为“集成”
6. 点击“添加”
7. 在集成页面搜索“12123”并安装/更新

### 手动安装

1. 下载此版本的源代码（zip 或 tar.gz）
2. 将 `custom_components/12123` 文件夹复制到你的 Home Assistant `custom_components` 目录
3. 重启 Home Assistant

## 配置

在 Home Assistant 中通过 UI 配置此集成：

1. 进入“设置” > “设备与服务”
2. 点击“添加集成”
3. 搜索“12123”
4. 按照提示完成配置

## 注意事项

- 本集成是第三方开发，与 12123 官方无关
- 使用本集成需要遵守相关法律法规和 12123 的服务条款
- 如遇问题，请开启 debug 日志并附带相关信息反馈

