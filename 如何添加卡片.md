# 如何在 Home Assistant 中添加 12123 卡片

## 前提条件

### 1. 安装 button-card 插件

1. 打开 Home Assistant
2. 进入 **HACS**（如果还没有安装 HACS，请先安装）
3. 在 HACS 中搜索 **"button-card"**
4. 点击安装
5. **重启 Home Assistant**

### 2. 准备图片资源（可选）

如果你使用了自定义图片，需要将图片放到 Home Assistant 的 `www` 目录：

1. 在 Home Assistant 配置目录下创建 `www` 文件夹（如果不存在）
2. 将以下图片放入 `www` 目录：
   - `交管12123.png` - 12123 图标
   - `update.png` - 更新图标

**路径示例：**
```
/config/www/交管12123.png
/config/www/update.png
```

如果不想使用图片，可以修改卡片配置中的图片路径部分。

## 添加卡片方法

### 方法一：通过 UI 编辑器（推荐）

1. **进入仪表盘编辑模式**
   - 打开你的仪表盘
   - 点击右上角的 **三个点** (⋮)
   - 选择 **"编辑仪表盘"**

2. **添加新卡片**
   - 点击 **"添加卡片"** 按钮
   - 选择 **"手动"** 或 **"通过 YAML 编辑器"**

3. **粘贴卡片配置**
   - 打开 `button_card_config.yaml` 文件
   - 复制全部内容
   - 粘贴到卡片编辑器中
   - 点击 **"保存"**

4. **调整位置**
   - 拖动卡片到想要的位置
   - 点击右上角的 **"完成"** 保存仪表盘

### 方法二：直接编辑 YAML

1. **进入仪表盘编辑模式**
   - 打开你的仪表盘
   - 点击右上角的 **三个点** (⋮)
   - 选择 **"编辑仪表盘"**

2. **切换到 YAML 模式**
   - 点击右上角的 **三个点** (⋮)
   - 选择 **"以 YAML 模式编辑"**

3. **添加卡片配置**
   - 在 `cards:` 列表中添加卡片配置
   - 示例：

```yaml
type: custom:button-card
name: >
  [[[
  const time = states['sensor.12123_wei_zhang_xin_xi'].attributes?.['update'] ?? states['sensor.12123_wei_zhang_xin_xi'].attributes?.['数据更新时间'] ?? '获取失败';
  return `<img src="/local/交管12123.png" width="25" style="vertical-align: text-bottom; margin-right: 8px; position: relative; top: 1px;">
          交管12123 
          <span style="margin-left: 10px; font-size: 14px; position: relative; top: -1px;">
            ${time}更新
            <img src="/local/update.png" width="16" style="vertical-align: text-bottom; margin-left: 4px;transform: rotate(-45deg);">
          </span>`;
  ]]]
# ... 其他配置
```

4. **保存**
   - 点击 **"保存"**
   - 退出编辑模式

## 完整示例（仪表盘 YAML）

如果你想要一个完整的仪表盘配置示例：

```yaml
title: 我的仪表盘
path: dashboard
type: grid
cards:
  - type: custom:button-card
    # 这里粘贴 button_card_config.yaml 的全部内容
    name: >
      [[[
      const time = states['sensor.12123_wei_zhang_xin_xi'].attributes?.['update'] ?? '获取失败';
      return `<img src="/local/交管12123.png" width="25" style="vertical-align: text-bottom; margin-right: 8px; position: relative; top: 1px;">
              交管12123 
              <span style="margin-left: 10px; font-size: 14px; position: relative; top: -1px;">
                ${time}更新
                <img src="/local/update.png" width="16" style="vertical-align: text-bottom; margin-left: 4px;transform: rotate(-45deg);">
              </span>`;
      ]]]
    # ... 继续粘贴其他配置
```

## 注意事项

### 1. 传感器名称检查

确保你的传感器名称与卡片配置中的一致：
- `sensor.12123_jia_shi_zheng_xin_xi` - 驾驶证信息
- `sensor.12123_che_liang_xin_xi` - 车辆信息
- `sensor.12123_wei_zhang_xin_xi` - 违章信息

如果名称不同，需要修改卡片配置中的传感器名称。

### 2. 图片路径

如果不想使用图片，可以修改配置：

```yaml
# 将这部分：
<img src="/local/交管12123.png" width="25" ...>

# 改为：
交管12123
```

或者使用 Material Design Icons：

```yaml
# 使用图标代替图片
mdi:car
```

### 3. 样式调整

如果需要调整样式，可以修改 `styles:` 部分：
- 修改字体大小：`font-size: 14px`
- 修改间距：`padding: 8px`
- 修改颜色：`color: #ffffff`

## 故障排除

### 问题：卡片不显示

1. **检查 button-card 是否安装**
   - 进入 HACS > 前端
   - 确认 button-card 已安装

2. **检查传感器是否存在**
   - 进入 **开发者工具** > **状态**
   - 搜索 `sensor.12123` 确认传感器存在

3. **检查 YAML 语法**
   - 进入 **开发者工具** > **YAML**
   - 检查是否有语法错误

### 问题：数据显示不正确

1. **检查传感器属性**
   - 进入 **开发者工具** > **状态**
   - 点击传感器查看属性
   - 确认属性名称与卡片配置一致

2. **查看浏览器控制台**
   - 按 F12 打开开发者工具
   - 查看 Console 是否有错误信息

## 快速开始（简化版）

如果你想要一个简化版本（不使用图片），可以使用这个：

```yaml
type: custom:button-card
name: 交管12123
show_icon: true
show_state: true
entity: sensor.12123_che_liang_xin_xi
```

然后逐步添加更多功能。

## 更多帮助

- [button-card 文档](https://github.com/custom-cards/button-card)
- [Home Assistant 社区](https://community.home-assistant.io/)


